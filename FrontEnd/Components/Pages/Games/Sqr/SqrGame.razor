@page "/Sqr/{operationType}/{numbersType}"
@using Microsoft.AspNetCore.Components.Authorization
@using global::FrontEnd.Components.Classes
@using global::FrontEnd.Components.Pages.Games.Sqr
@inherits SqrGameBase;
@inject NavigationManager NavManager
@rendermode InteractiveServer


@if(ready==true)
{
    <h1 style="text-align:center">Wybierz Liczbę </h1>
    <p style="height:10px"></p>

     Random rnd = new Random();
    int correct = rnd.Next(0,wrongAnwsers.Count+1);
    int j = 0;

    <left>
    @if (numbersType =="fraction")
    {
        if(roundType=="sqr"){
            <h2><b> (
                <div class="frac"> 
                    <span>@exerciseNumber</span>  
                    <span class="symbol">/</span>
                    <span class="bottom"> @exerciseDenumerator </span> 
                </div> ) 
             <sup>@power</sup>  = </b></h2>
        }else
        {
            if(power==2){
                <h2><b> &radic; (
                    <div class="frac"> 
                        <span>@exerciseNumber</span>  
                        <span class="symbol">/</span>
                        <span class="bottom"> @exerciseDenumerator </span> 
                    </div> )   = 
                </b></h2>
            }else
            {
                <h2><b> &#8731 (
                    <div class="frac"> 
                        <span>@exerciseNumber</span>  
                        <span class="symbol">/</span>
                        <span class="bottom"> @exerciseDenumerator </span> 
                    </div> )   = 
                </b></h2>
            }
        }
    }else
    {
        if(roundType=="sqr"){
            <h2><b> @exerciseNumber<sup>@power</sup>  = </b></h2>
        }else
        {
            if(power==2){
                <h2><b> &radic; @exerciseNumber  = </b></h2>
            }else
            {
                <h2><b> &#8731 @exerciseNumber  = </b></h2>
            }
        } 
    }
    <p style="height:5px"></p>

   
    @for (int i=0;i<wrongAnwsers.Count+1;i++)
    {
        if (i == correct)
        {
            if(numbersType =="fraction")
            {
                 <button class="gamebtns" @onclick="GoodNumber">
                     <div class="frac"> 
                        <span>@correctNumber</span>  
                        <span class="symbol">/</span>
                        <span class="bottom"> @correctDenumerator </span> 
                    </div>
                 </button> <label style="padding-left:20px"></label>
                
            }else{
                <button class="gamebtns" @onclick="GoodNumber">@correctNumber</button> <label style="padding-left:20px"></label>
            }
        }else
        {
            if(numbersType =="fraction")
            {
                <button class="gamebtns" @onclick ="gameBase.WrongAnswer">
                    <div class="frac"> 
                        <span> @wrongAnwsers[j]</span>  
                        <span class="symbol">/</span>
                        <span class="bottom"> @wrongAnwsersDen[j] </span> 
                    </div>
                </button> <label style="padding-left:20px"></label>
            }
            else
            {
                <button class="gamebtns" @onclick ="gameBase.WrongAnswer">@wrongAnwsers[j]</button> <label style="padding-left:20px"></label>
            }
            j++;
        }
    }
    <p style="height:5px"></p>
    <button class="helpbtn" @onclick="Help">Pomoc</button>

    <p style="height:5px"></p>
    <p>@gameBase.message</p>
    <p style="height:5px"></p>
    <p>Wynik: @gameBase.good / @gameBase.all </p>
    <p style="height:50px"></p>
    <button class="backbtn" @onclick="GoBack">Cofnij</button>
   </left>
    <right>
        @if(showHelp == true)
        {
            <h2>Pomoc: </h2>
            if(numbersType =="fraction")
            {
                if (power == 2)
                {
                    if (operationType == "sqr")
                    {
                        <label style="font-size:25px">(
                            <div class="frac"> 
                            <span>@exerciseNumber</span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> @exerciseDenumerator </span> 
                        </div> )  * (
                        <div class="frac"> 
                            <span>@exerciseNumber</span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> @exerciseDenumerator </span> 
                        </div> )  = 
                        
                       
                        <div class="frac"> 
                            <span> <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px "></InputNumber></span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px"></InputNumber> </span> 
                        </div>  
                        </label>
                    }else
                    {
                        <p style="font-size:25px"> @exerciseNumber = <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px "></InputNumber> * <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px "></InputNumber> </p>
                        <p style="font-size:25px"> @exerciseDenumerator = <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px "></InputNumber> * <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px "></InputNumber> </p>

                    }
                }else
                {
                    if (operationType == "sqr")
                    {
                     <label style="font-size:25px">(
                        <div class="frac"> 
                            <span>@exerciseNumber</span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> @exerciseDenumerator </span> 
                        </div> )  * (
                        <div class="frac"> 
                            <span>@exerciseNumber</span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> @exerciseDenumerator </span> 
                        </div> )  = 
                        
                        (
                        <div class="frac"> 
                            <span> <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber></span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px"></InputNumber> </span> 
                        </div> )  * (
                        <div class="frac"> 
                            <span>@exerciseNumber</span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> @exerciseDenumerator </span> 
                        </div> ) =
                          <div class="frac"> 
                            <span> <InputNumber @bind-Value="@help[2]" style="width:50px;font-size:15px"></InputNumber></span>  
                            <span class="symbol">/</span>
                            <span class="bottom"> <InputNumber @bind-Value="@help[3]" style="width:50px;font-size:15px"></InputNumber> </span> 
                        </div>


                        </label>
                    }else
                    {
                        <p style="font-size:25px"> @exerciseNumber = <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px "></InputNumber> * <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px "></InputNumber> * <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px "></InputNumber></p>
                        <p style="font-size:25px"> @exerciseDenumerator = <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px "></InputNumber> * <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px "></InputNumber> * <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px "></InputNumber></p>

                    }

                }
            }else
            {
                if (power == 2)
                {
                    if (operationType == "sqr")
                    {
                        <label style="font-size:25px">@exerciseNumber * @exerciseNumber = <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber></label>
                    }else
                    {
                        <label style="font-size:25px">@exerciseNumber = <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber> * <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber></label>
                    }
                }else
                {
                     if (operationType == "sqr")
                    {
                    <label style="font-size:25px">@exerciseNumber * @exerciseNumber * @exerciseNumber = 
                        <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber> * @exerciseNumber = 
                            <InputNumber @bind-Value="@help[1]" style="width:50px;font-size:15px"></InputNumber></label>
                    }else
                    {
                        <label style="font-size:25px">@exerciseNumber = <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber> * <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber> * <InputNumber @bind-Value="@help[0]" style="width:50px;font-size:15px"></InputNumber></label>
                        
                    }
                }
            }
        }

    </right>
}else
{
    <h2 style="text-align:center"><b>Koniec Gry!</b></h2>
    <p style="height:10px"></p>
    <h4>Twój wynik to: @gameBase.good / @gameBase.all </h4>

    <p style="height:50px"></p>
    <button class="backbtn" @onclick="GoBack">Cofnij</button>
}


@code {
    [CascadingParameter]
    private Task<AuthenticationState> authenticationStateTask { get; set; }

    GamesBase gameBase = new GamesBase("Potęgi i Pierwiastki", "Gry");
  
    private int[] help = new int[4];

    private bool showHelp = false;

    private async Task GoodNumber()
    {
        await gameBase.GoodAnswer();
        if (gameBase.all >= 10)
        {
            ready = false;
            await gameBase.UpdateUserScore(authenticationStateTask, userProgressService);
            return;
        }

        PrepareNewGame();
        showHelp = false;
        help = new int[4];
    }

    private void Help()
    {
        if (showHelp == false)
        {
            showHelp = true;
        }else
        {
            showHelp = false;
        }
    }

    private async Task GoBack()
    {
        await gameBase.UpdateUserScore(authenticationStateTask, userProgressService);
        NavManager.NavigateTo("ChooseGame/uname/Potęgi i Pierwiastki");
    }
}
