@page "/BiggerSmaller/{type}"
@using DTO.DTOs
@using Microsoft.AspNetCore.Components.Authorization
@rendermode InteractiveServer
@inherits CountingUpDownBase;
@inject NavigationManager NavManager


<PageTitle>Większe Mniejsze</PageTitle>


@if(ready==true)
{
    <h1 style="text-align:center">Wybierz Poprawną Liczbę </h1>
    <p style="height:10px"></p>
    Random rnd = new Random();
    int correct = rnd.Next(0,4);

    if(type == "fractions")
    {
        <h2><b> 
            <div class="frac"> 
                <span>@excerciseNumber</span>  
                <span class="symbol">/</span>
                <span class="bottom"> @excerciseNumberDen </span>
            </div>
            @excercise
            </b>
        </h2> 
       
        <p style="height:10px"></p>
        
        for (int i=0;i<4;i++)
        {
            if (i == correct)
            {
                <label style="padding-left:10px; padding-bottom:5px">
                <button class="gamebtns" @onclick="GoodNumber">
                    <div class="frac">
                        <span>@correctNumber</span>
                        <span class="symbol">/</span>
                        <span class="bottom"> @correctNumberDen </span>
                    </div>
                </button> 
                </label>
            }else
            {
                <label style="padding-left:10px; padding-bottom:5px">
                    <button class="gamebtns" @onclick="gameBase.WrongAnswer">
                        <div class="frac">
                            <span>@wrongNumbers[i]</span>
                            <span class="symbol">/</span>
                            <span class="bottom"> @wrongNumbersDen[i] </span>
                        </div>
                    </button> 
                </label>
            }
        }
    }else{

        <h2><b> @excercise </b></h2>
        <p style="height:10px"></p>
        for (int i=0;i<4;i++)
        {
            if (i == correct)
            {
                <label style="padding-left:10px; padding-bottom:5px">
                    <button class="gamebtns" @onclick="GoodNumber">@correctNumber</button>
                </label>
            }else
            {
                <label style="padding-left:10px; padding-bottom:5px">
                    <button class="gamebtns" @onclick="gameBase.WrongAnswer">@wrongNumbers[i]</button>
                </label>
            }
        }
    }
    <p style="height:5px"></p>
    <p>@gameBase.message</p>
    <p style="height:5px"></p>
    <p>Wynik: @gameBase.good / @gameBase.all </p>
}else
{
     <h2 style="text-align:center"><b>Koniec Gry!</b></h2>
     <p style="height:10px"></p>
     <h4>Twój wynik to: @gameBase.good / @gameBase.all </h4>
}
<p style="height:50px"></p>
<button class="backbtn" @onclick="GoBack">Cofnij</button>

@code {
    [CascadingParameter]
    private Task<AuthenticationState> authenticationStateTask { get; set; }


    private async Task GoodNumber()
    {
        await gameBase.GoodAnswer();
        if (gameBase.all >= 10)
        {
            
            ready = false;
            await gameBase.UpdateUserScore(authenticationStateTask,userProgressService);           
            return;
        }

        PrepareNewGame();

    }


    private void GoBack()
    {
        switch(type)
        {       
            case "natural":
                NavManager.NavigateTo("ChooseGame/uname/Liczby Naturalne");

                break;
            case "minus":
                NavManager.NavigateTo("ChooseGame/uname/Liczby Całkowite");
                break;

            default:
                NavManager.NavigateTo("ChooseGame/uname/Podstawy Liczb");
                break;
        }

    }

}
