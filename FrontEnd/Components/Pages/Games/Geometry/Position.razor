@page "/GeometryPosition"
@using DTO.DTOs
@using Microsoft.AspNetCore.Components.Authorization
@using global::FrontEnd.Components.Classes
@using global::FrontEnd.Components.Pages.Games.Geometry
@inject NavigationManager NavManager

@rendermode InteractiveServer
@inherits PositionBase;

<PageTitle>Pozycja</PageTitle>


@if(ready==true)
{
    <h1 style="text-align:center">Uzupełnij zdanie </h1>
    switch (type)
    {
        case "nad":
            <img src="/Assets/@img1Name" alt="@img1Name" style="width:150px; height:150px"/> <p></p>
            <img src="/Assets/@img2Name" alt="@img2Name" style="width:150px; height:150px"/> <p></p>
            break;
        case "pod":
            <img src="/Assets/@img2Name" alt="@img2Name" style="width:150px; height:150px"/> <p></p>
            <img src="/Assets/@img1Name" alt="@img1Name" style="width:150px; height:150px"/> <p></p>
            break;
        case "na lewo od":
            <p><img src="/Assets/@img1Name" alt="@img1Name" style="width:150px; height:150px"/> <label style="padding-left:5px"></label>
            <img src="/Assets/@img2Name" alt="@img2Name" style="width:150px; height:150px"/></p>
            break;
        case "na prawo od":
            <p><img src="/Assets/@img2Name" alt="@img2Name" style="width:150px; height:150px"/> <label style="padding-left:5px"></label>
            <img src="/Assets/@img1Name" alt="@img1Name" style="width:150px; height:150px"/></p>
            break;
        case "na skos od":
            <img src="/Assets/@img1Name" alt="@img1Name" style="width:150px; height:150px"/> <p></p>
            <label style="padding-left:150px"></label>
            <img src="/Assets/@img2Name" alt="@img2Name" style="width:150px; height:150px"/>

            break;
    }

    <p style="height:5px"></p>
    <h2><b> @excercise1
        <InputSelect @bind-Value="userAnwser" , @onchange="@((ChangeEventArgs __e) => userAnwser = __e?.Value?.ToString())">
        @foreach (var t in types)
        {
            <option value="@t">@t</option>
        }
        </InputSelect>
        
        <label> @excercise2 </label>

    </b></h2>

    <p style="height:10px"></p>
    <button class="gamebtns" @onclick="Confirm">Potwierdź</button>   
    <p style="height:5px"></p>
    <p>@gameBase.message</p>
    <p style="height:5px"></p>
    <p>Wynik: @gameBase.good / @gameBase.all </p>
}else
{
    <h2 style="text-align:center"><b>Koniec Gry!</b></h2>
    <p style="height:10px"></p>
    <h4>Twój wynik to: @gameBase.good / @gameBase.all </h4>
}
<p style="height:50px"></p>
<button class="backbtn" @onclick="GoBack">Cofnij</button>


@code {
    [CascadingParameter]
    private Task<AuthenticationState> authenticationStateTask { get; set; }

    string userAnwser="";

    GamesBase gameBase = new GamesBase("Podstawy figur geometrycznych","Gry");


    private async Task Confirm()
    {
        if(userAnwser == type)
        {
            await gameBase.GoodAnswer();
            if (gameBase.all >= 10)
            {
                ready = false;
                await gameBase.UpdateUserScore(authenticationStateTask,userProgressService);
                return;
            }
            PrepareNewGame();
            userAnwser = "";
        }else
        {
            await gameBase.WrongAnswer();
        }
    }

    private async Task GoBack()
    {
        await gameBase.UpdateUserScore(authenticationStateTask, userProgressService);
        NavManager.NavigateTo("ChooseGame/uname/Podstawy figur geometrycznych");
    }
}
