@inherits BiggerSmallerLvl3Base
<PageTitle>Większe Mniejsze</PageTitle>
@page "/BiggerSmaller/GiveNumber/{type}"
@using DTO.DTOs
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager NavManager
@rendermode InteractiveServer

@if(ready==true){
    <h1 style="text-align:center">Podaj Poprawną Liczbę </h1>
    <p style="height:10px"></p>
    <h2>
        @excerciseNumber
        @switch (symbol)
        {
            case 0:                                                     //  =
                <label style ="padding-left:5px; padding-right:5px"> &#61; </label>
                break;
            case 1:                                                     //  <
                <labek style="padding-left:5px; padding-right:5px"> &#60 </labek>
                break;
            case 2:                                                     //  >
                <label style="padding-left:5px; padding-right:5px"> &#62; </label>
                break;
            case 3:                                                     // >=
                <label style="padding-left:5px; padding-right:5px"> &ge;  </label>
                break;
            case 4:                                                     
                <label style="padding-left:5px; padding-right:5px"> &le; </label>
                 break;
        }
        <InputNumber @bind-Value="UserAnwser" @onkeydown="@Enter" style="width:100px" />
    </h2>

    <p style="height:10px"></p>
    <button class="confbtn" @onclick="Confirm">Potwierdź</button>
    <p style="height:5px"></p>
    <p>@gameBase.message</p>
    <p style="height:5px"></p>
    <p>Wynik: @gameBase.good / @gameBase.all </p>
}else
{
    <h2 style="text-align:center"><b>Koniec Gry!</b></h2>
    <p style="height:10px"></p>
    <h4>Twój wynik to: @gameBase.good / @gameBase.all </h4>

}
<p style="height:50px"></p>
<button class="backbtn" @onclick="GoBack">Cofnij</button>

@code {
    [CascadingParameter]
    private Task<AuthenticationState> authenticationStateTask { get; set; }


    private int UserAnwser;

    private async Task Confirm()
    {
        switch (symbol)
        {
            case 0:                                                     //  =
                if (UserAnwser == excerciseNumber)
                {
                    await gameBase.GoodAnswer();

                }
                else
                {
                    await gameBase.WrongAnswer();
                    return;
                }
                break;

            case 1:                                                     //  <
                if (excerciseNumber < UserAnwser)
                {
                    await gameBase.GoodAnswer();

                }
                else
                {
                    await gameBase.WrongAnswer();
                    return;
                }
                break;

            case 2:                                                     //  >
                if (excerciseNumber > UserAnwser)
                {
                    await gameBase.GoodAnswer();

                }
                else
                {
                    await gameBase.WrongAnswer();
                    return;
                }
                break;

            case 3:                                                     // >=
                if (excerciseNumber >= UserAnwser)
                {
                    await gameBase.GoodAnswer();
                }
                else
                {
                    await gameBase.WrongAnswer();
                    return;
                }

                break;
            case 4:                                                     // <=   &le;
                if (excerciseNumber <= UserAnwser)
                {
                    await gameBase.GoodAnswer();

                }
                else
                {
                    await gameBase.WrongAnswer();
                    return;
                }
                break;
        }

        if (gameBase.all >= 10)
        {
            ready = false;
            await gameBase.UpdateUserScore(authenticationStateTask, userProgressService);
            return;
        }

        PrepareNewGame();
        UserAnwser = 0;
        gameBase.message = "";
    }

    public async Task Enter(KeyboardEventArgs e)
    {
        if (e.Code == "Enter" || e.Code == "NumpadEnter")
        {
            await Task.Delay(500);
            await Confirm();
        }
    }

  
    private async Task GoBack()
    {
       await gameBase.UpdateUserScore(authenticationStateTask, userProgressService);
        switch (type)
        {
            case "natural":
                NavManager.NavigateTo("ChooseGame/uname/Liczby Naturalne");

                break;
            case "minus":
                NavManager.NavigateTo("ChooseGame/uname/Liczby Całkowite");

                break;
            default:
                NavManager.NavigateTo("ChooseGame/uname/Podstawy Liczb");
                break;
        }
    }
}
