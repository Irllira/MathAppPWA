@page "/FractionsDec/{type}"
@using DTO.DTOs
@using Microsoft.AspNetCore.Components.Authorization
@using global::FrontEnd.Components.Classes
@using global::FrontEnd.Components.Pages.Games.Fractions
@rendermode InteractiveServer
@inherits FractionsDecBase;
@inject NavigationManager NavManager


<PageTitle>Ułamki Dziesiętne</PageTitle>


@if(ready==true)
{
    <h1 style="text-align:center">Wybierz Poprawną Liczbę </h1>
    <p style="height:10px"></p>

    if(type == "toDec"){
        
        <h2 ><b> <div class="frac"> <span>@numerator</span>  <span class="symbol">/</span><span class="bottom"> @denominator </span> </div>= </b></h2>
        <p style="height:5px"></p>
        Random rnd = new Random();
        int correct = rnd.Next(0,wrongAnwsers.Count()+1);
        int j = 0;
        for (int i=0;i<wrongAnwsers.Count()+1;i++)
        {
            if (i == correct)
            {
                <button class="btn btn-primary" @onclick="GoodNumber">@correctNumber</button> <label style="padding-left:20px"></label>
            }else
            {
                <button class="btn btn-primary" @onclick ="gamesBase.WrongAnswer">@wrongAnwsers[j]</button> <label style="padding-left:20px"></label>
                j++;
            }
        }
    } else
    {
        <h2><b> @excerciseNumber = </b></h2>
        <p style="height:5px"></p>
        Random rnd = new Random();
        int correct = rnd.Next(0,wrongNumAnwsers.Count()+1);
        int j = 0;
        for (int i=0;i<wrongNumAnwsers.Count()+1;i++)
        {
            if (i == correct)
            {
                <button class="gamebtns" @onclick="GoodNumber"> <div class="frac"> 
                    <span>@correctNumAnwser</span>  
                    <span class="symbol">/</span>
                    <span class="bottom"> @correctDenAnwser </span> 
                </div></button> <label style="padding-left:20px"></label>
            }else
            {
                <button class="gamebtns" @onclick ="gamesBase.WrongAnswer" style="width:70px">  <div class="frac"> 
                    <span>@wrongNumAnwsers[j]</span>  
                    <span class="symbol">/</span>
                    <span class="bottom"> @wrongDenAnwsers[j] </span> 
                </div> </button> <label style="padding-left:20px"></label>
                j++;
            }
        }
    }
    <p style="height:5px"></p>
    <p>@gamesBase.message</p>
    <p style="height:5px"></p>
    <p>Wynik: @gamesBase.good / @gamesBase.all </p>
}else
{
    <h2 style="text-align:center"><b>Koniec Gry!</b></h2>
    <p style="height:10px"></p>
    <h4>Twój wynik to: @gamesBase.good / @gamesBase.all </h4>
}
<p style="height:50px"></p>
<button class="backbtn" @onclick="GoBack">Cofnij</button>

@code {
    [CascadingParameter]
    private Task<AuthenticationState> authenticationStateTask { get; set; }

    GamesBase gamesBase = new GamesBase("Ułamki","Gry");

    private async Task GoodNumber()
    {
        await gamesBase.GoodAnswer();
        if (gamesBase.all >= 10)
        {
            ready = false;
            await gamesBase.UpdateUserScore(authenticationStateTask,userProgressService);
            return;
        }
        PrepareNewGame();
    }

    private async Task GoBack()
    {
        await gamesBase.UpdateUserScore(authenticationStateTask, userProgressService);
        NavManager.NavigateTo("ChooseGame/uname/Ułamki");
    }
}
